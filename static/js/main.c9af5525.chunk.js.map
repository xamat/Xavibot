{"version":3,"sources":["GlobalState.js","config.js","MessageParser.js","ActionProvider.js","ChatbotContainer.js","App.js","index.js"],"names":["globalState","threadId","assistantId","setThreadId","id","this","setAssistantId","config","initialMessages","createChatBotMessage","React","createElement","dangerouslySetInnerHTML","__html","botName","customStyles","botMessageBox","backgroundColor","chatButton","state","gist","infoBox","widgets","MessageParser","constructor","actionProvider","getContext","parse","message","lowerCaseMessage","toLowerCase","includes","handleHello","handleHelp","sendMessageToAssistantBackend","ActionProvider","setStateFunc","createClientMessage","idToken","setState","sendMessageToBackend","bind","addBotMessage","botMessage","updateChatbotState","greet","greetingMessage","helpMessage","handleUnknown","unknownMessage","userMessage","response","axios","post","data","error","console","addMessageToChat","chatMessage","prevState","messages","ChatbotContainer","isInitialized","setIsInitialized","useState","useEffect","async","apiUrl","process","log","get","assistantResponse","threadResponse","initializeChatbot","Chatbot","headerText","super","messageParser","App","className","ReactDOM","createRoot","document","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.c9af5525.chunk.js","sourcesContent":["// globalState.js\nconst globalState = {\n    threadId: null,\n    assistantId: null,\n    setThreadId: function(id) { this.threadId = id; },\n    setAssistantId: function(id) { this.assistantId = id; }\n  };\n  \n  export default globalState;\n  ","// Config starter code\n  \n  import { createChatBotMessage } from 'react-chatbot-kit';\n  import React from 'react';\n\n  const config = {\n    initialMessages: [\n      createChatBotMessage(\n        <div \n        dangerouslySetInnerHTML={{ __html:`This is a chatbot designed to respond as Xavi Amatriain.<br> \n        <p>For more details on how this chatbot was created, read the <a href=\"https://amatria.in/blog/aidevelopment\" target=\"_blank\" rel=\"noopener noreferrer\">blogpost</a>.It provides\n        a link to the codebase in Github among other things.</p>\n        <p>If you prefer to ask questions and listen to an audio overview, you should visit my \n        <a href=\"https://notebooklm.google.com/notebook/56e35827-04fd-4f93-8f7d-9eaab9bf3852?_gl=1*1ojl3rl*_ga*ODMwNTc0ODMuMTc0OTI3OTM0Mg..*_ga_W0LDH41ZCB*czE3NDkyNzkzNDIkbzEkZzAkdDE3NDkyNzkzNDIkajYwJGwwJGgw&pli=1\"\n        target=\"_blank\" rel=\"noopener noreferrer\">NotebookLM notebook</a>\n        </p>\n        All that being said, how can I help you today, human? `\n         }}>\n      </div>\n      ),\n      \n    ],\n    // ... other config options\n    botName: 'XaviBot',\n    customStyles: {\n        botMessageBox: {\n          backgroundColor: '#376B7E',\n        },\n        chatButton: {\n          backgroundColor: '#5ccc9d',\n        },\n      },\n      state: {\n        gist: '',\n        infoBox: '',\n      },\n      widgets: [],\n  };\n\n  \n  export default config;\n  \n","// MessageParser.js\n\nclass MessageParser {\n  \n  constructor(actionProvider, getContext) {\n    this.actionProvider = actionProvider;\n  }\n\n  parse(message) {\n    const lowerCaseMessage = message.toLowerCase();\n\n    if (lowerCaseMessage.includes(\"hello\")) {\n      this.actionProvider.handleHello();\n    } else if (lowerCaseMessage.includes(\"help\")) {\n      this.actionProvider.handleHelp();\n    } else {\n      // Send the message to the assistant backend\n      this.actionProvider.sendMessageToAssistantBackend(message);\n    }\n  }\n}\nexport default MessageParser;\n\n ","//import React from 'react';\nimport axios from 'axios';\n\nclass ActionProvider {\n    constructor(createChatBotMessage, setStateFunc, createClientMessage, idToken) {\n      this.createChatBotMessage = createChatBotMessage;\n      this.setState = setStateFunc;\n      this.createClientMessage = createClientMessage;\n      this.idToken = idToken;\n      this.threadId = null;\n      this.assistantId = null;\n      this.sendMessageToBackend = this.sendMessageToBackend.bind(this);\n      this.sendMessageToAssistantBackend = this.sendMessageToAssistantBackend.bind(this);\n    }\n  \n    setThreadId(threadId) {\n      this.threadId = threadId;\n    }\n\n    setAssistantId(assistantId) {\n      this.assistantId = assistantId;\n    }\n\n    addBotMessage(message) {\n      const botMessage = this.createChatBotMessage(message);\n      this.updateChatbotState(botMessage);\n    }\n  \n    greet() {\n      const greetingMessage = this.createChatBotMessage(\"Hello! How can I help you?\");\n      this.updateChatbotState(greetingMessage);\n    }\n  \n    handleHello() {\n      const greetingMessage = this.createChatBotMessage(\"Hello! How can I help you?\");\n      this.updateChatbotState(greetingMessage);\n    }\n  \n    handleHelp() {\n      const helpMessage = this.createChatBotMessage(\"Here's some help...\");\n      this.updateChatbotState(helpMessage);\n    }\n  \n    handleUnknown() {\n      const unknownMessage = this.createChatBotMessage(\"Sorry, I didn't understand that.\");\n      this.updateChatbotState(unknownMessage);\n    }\n\n    async sendMessageToBackend(userMessage) {\n      const apiUrl = process.env.REACT_APP_API_URL;  \n      \n      try {\n        const response = await axios.post(`${apiUrl}/chatWithAssistant`, {\n          message: userMessage,\n          threadId: this.threadId,\n          assistantId: this.assistantId\n        });\n        \n        if (response.data && response.data.message) {\n          this.addBotMessage(response.data.message);\n        } else {\n          this.addBotMessage('Sorry, I received an empty response from the server.');\n        }\n      } catch (error) {\n        console.error('Error communicating with backend:', error);\n        this.addBotMessage('Sorry, I encountered an error while processing your message.');\n      }\n    }\n\n    async sendMessageToAssistantBackend(userMessage) {\n      const apiUrl = process.env.REACT_APP_API_URL;\n      \n      try {\n        const response = await axios.post(`${apiUrl}/chatWithAssistant`, {\n          message: userMessage,\n          threadId: this.threadId,\n          assistantId: this.assistantId\n        });\n        \n        if (response.data && response.data.message) {\n          this.addBotMessage(response.data.message);\n        } else {\n          this.addBotMessage('Sorry, I received an empty response from the server.');\n        }\n      } catch (error) {\n        console.error('Error communicating with assistant backend:', error);\n        this.addBotMessage('Sorry, I encountered an error while processing your message.');\n      }\n    }\n    \n    addMessageToChat(message) {\n      const chatMessage = this.createChatBotMessage(message);\n      this.updateChatbotState(chatMessage);\n    }\n  \n    updateChatbotState(message) {\n      this.setState(prevState => ({\n        ...prevState,\n        messages: [...prevState.messages, message]\n      }));\n    }\n  }\n  \n  export default ActionProvider;\n ","import React, { useEffect, useState } from 'react';\nimport globalState from './GlobalState.js';\nimport config from './config.js';\nimport MessageParser from './MessageParser.js';\nimport ActionProvider from './ActionProvider.js';\nimport Chatbot from 'react-chatbot-kit';\nimport axios from 'axios';\n\nfunction ChatbotContainer() {\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  useEffect(() => {\n    const initializeChatbot = async () => {\n      try {\n        const apiUrl = process.env.REACT_APP_API_URL;\n\n        // Pre-warm the backend to reduce first message latency\n        console.log('Pre-warming backend...');\n        await axios.get(`${apiUrl}/prewarm`);\n        console.log('Backend pre-warmed successfully');\n\n        // Create Assistant and store its ID\n        const assistantResponse = await axios.post(`${apiUrl}/get-assistant`);\n        globalState.setAssistantId(assistantResponse.data);\n        \n        // Create Thread and Update Global State\n        const threadResponse = await axios.post(`${apiUrl}/create-thread`);\n        globalState.setThreadId(threadResponse.data);\n        \n        setIsInitialized(true);\n      } catch (error) {\n        console.error('Error initializing chatbot:', error);\n      }\n    };\n    \n    initializeChatbot();\n  }, []);\n\n  // Create a custom ActionProvider class that doesn't require authentication\n  class CustomActionProvider extends ActionProvider {\n    constructor(createChatBotMessage, setStateFunc, createClientMessage) {\n      super(createChatBotMessage, setStateFunc, createClientMessage, null);\n      \n      // Set the thread and assistant IDs after initialization\n      this.setThreadId(globalState.threadId);\n      this.setAssistantId(globalState.assistantId);\n    }\n  }\n\n  if (!isInitialized) {\n    return <div>Initializing chatbot...</div>;\n  }\n\n  return (\n    <Chatbot\n      config={config}\n      headerText='Xavibot'\n      actionProvider={CustomActionProvider}\n      messageParser={MessageParser}\n    />\n  );\n}\n\nexport default ChatbotContainer;","import './App.css';\nimport 'react-chatbot-kit/build/main.css';\nimport React from 'react';\nimport ChatbotContainer from './ChatbotContainer';\n \nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <ChatbotContainer />\n      </header>\n    </div>\n  ); \n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n//import reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n"],"sourceRoot":""}